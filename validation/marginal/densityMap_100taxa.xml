<beast version="2.0"
       namespace="beast.core
                 :beast.core.util
                 :beast.core.parameter
                 :beast.evolution.alignment
                 :beast.evolution.likelihood
                 :beast.evolution.tree
                 :beast.evolution.tree.coalescent
                 :beast.evolution.sitemodel
                 :beast.evolution.substitutionmodel
                 :beast.evolution.operators
                 :beast.math.distributions
                 :feast.simulation
                 :feast.mapping
                 :coalre.network
                 :coalre.distribution
                 :coalre.distribution.marginal
                 :coalre.statistics
                 :coalre.simulator">

    <network id="network" spec="SimulatedCoalescentNetwork" fileName="$(filebase).trueNetwork.nexus"
             enableSegmentTreeUpdate="true">
        <populationModel id="truePopModel" spec="ConstantPopulation">
            <popSize id="truePopSize" spec="RealParameter" value="1.0"/>
        </populationModel>

        <reassortmentRate id="trueReassortmentRate" spec="RealParameter" value="1.0"/>

        <segmentTree id="segment1" spec="Tree" trait="@traitSet" taxonset="@taxonSet"/>
        <segmentTree id="segment2" spec="Tree" trait="@traitSet" taxonset="@taxonSet"/>
        <segmentTree id="segment3" spec="Tree" trait="@traitSet" taxonset="@taxonSet"/>
        <segmentTree id="segment4" spec="Tree" trait="@traitSet" taxonset="@taxonSet"/>
        <segmentTree id="segment5" spec="Tree" trait="@traitSet" taxonset="@taxonSet"/>
        <segmentTree id="segment6" spec="Tree" trait="@traitSet" taxonset="@taxonSet"/>
        <segmentTree id="segment7" spec="Tree" trait="@traitSet" taxonset="@taxonSet"/>
        <segmentTree id="segment8" spec="Tree" trait="@traitSet" taxonset="@taxonSet"/>

        <traitSet spec="TraitSet" traitname="date-backward" id="traitSet">
            <taxa spec="TaxonSet" id="taxonSet">

                <taxon spec="Taxon" id="t1"/>
                <taxon spec="Taxon" id="t2"/>
                <taxon spec="Taxon" id="t3"/>
                <taxon spec="Taxon" id="t4"/>
                <taxon spec="Taxon" id="t5"/>
                <taxon spec="Taxon" id="t6"/>
                <taxon spec="Taxon" id="t7"/>
                <taxon spec="Taxon" id="t8"/>
                <taxon spec="Taxon" id="t9"/>
                <taxon spec="Taxon" id="t10"/>

                <taxon spec="Taxon" id="t11"/>
                <taxon spec="Taxon" id="t12"/>
                <taxon spec="Taxon" id="t13"/>
                <taxon spec="Taxon" id="t14"/>
                <taxon spec="Taxon" id="t15"/>
                <taxon spec="Taxon" id="t16"/>
                <taxon spec="Taxon" id="t17"/>
                <taxon spec="Taxon" id="t18"/>
                <taxon spec="Taxon" id="t19"/>
                <taxon spec="Taxon" id="t20"/>

                <taxon spec="Taxon" id="t21"/>
                <taxon spec="Taxon" id="t22"/>
                <taxon spec="Taxon" id="t23"/>
                <taxon spec="Taxon" id="t24"/>
                <taxon spec="Taxon" id="t25"/>
                <taxon spec="Taxon" id="t26"/>
                <taxon spec="Taxon" id="t27"/>
                <taxon spec="Taxon" id="t28"/>
                <taxon spec="Taxon" id="t29"/>
                <taxon spec="Taxon" id="t30"/>

                <taxon spec="Taxon" id="t31"/>
                <taxon spec="Taxon" id="t32"/>
                <taxon spec="Taxon" id="t33"/>
                <taxon spec="Taxon" id="t34"/>
                <taxon spec="Taxon" id="t35"/>
                <taxon spec="Taxon" id="t36"/>
                <taxon spec="Taxon" id="t37"/>
                <taxon spec="Taxon" id="t38"/>
                <taxon spec="Taxon" id="t39"/>
                <taxon spec="Taxon" id="t40"/>

                <taxon spec="Taxon" id="t41"/>
                <taxon spec="Taxon" id="t42"/>
                <taxon spec="Taxon" id="t43"/>
                <taxon spec="Taxon" id="t44"/>
                <taxon spec="Taxon" id="t45"/>
                <taxon spec="Taxon" id="t46"/>
                <taxon spec="Taxon" id="t47"/>
                <taxon spec="Taxon" id="t48"/>
                <taxon spec="Taxon" id="t49"/>
                <taxon spec="Taxon" id="t50"/>

                <taxon spec="Taxon" id="t51"/>
                <taxon spec="Taxon" id="t52"/>
                <taxon spec="Taxon" id="t53"/>
                <taxon spec="Taxon" id="t54"/>
                <taxon spec="Taxon" id="t55"/>
                <taxon spec="Taxon" id="t56"/>
                <taxon spec="Taxon" id="t57"/>
                <taxon spec="Taxon" id="t58"/>
                <taxon spec="Taxon" id="t59"/>
                <taxon spec="Taxon" id="t60"/>

                <taxon spec="Taxon" id="t61"/>
                <taxon spec="Taxon" id="t62"/>
                <taxon spec="Taxon" id="t63"/>
                <taxon spec="Taxon" id="t64"/>
                <taxon spec="Taxon" id="t65"/>
                <taxon spec="Taxon" id="t66"/>
                <taxon spec="Taxon" id="t67"/>
                <taxon spec="Taxon" id="t68"/>
                <taxon spec="Taxon" id="t69"/>
                <taxon spec="Taxon" id="t70"/>

                <taxon spec="Taxon" id="t71"/>
                <taxon spec="Taxon" id="t72"/>
                <taxon spec="Taxon" id="t73"/>
                <taxon spec="Taxon" id="t74"/>
                <taxon spec="Taxon" id="t75"/>
                <taxon spec="Taxon" id="t76"/>
                <taxon spec="Taxon" id="t77"/>
                <taxon spec="Taxon" id="t78"/>
                <taxon spec="Taxon" id="t79"/>
                <taxon spec="Taxon" id="t80"/>

                <taxon spec="Taxon" id="t81"/>
                <taxon spec="Taxon" id="t82"/>
                <taxon spec="Taxon" id="t83"/>
                <taxon spec="Taxon" id="t84"/>
                <taxon spec="Taxon" id="t85"/>
                <taxon spec="Taxon" id="t86"/>
                <taxon spec="Taxon" id="t87"/>
                <taxon spec="Taxon" id="t88"/>
                <taxon spec="Taxon" id="t89"/>
                <taxon spec="Taxon" id="t90"/>

                <taxon spec="Taxon" id="t91"/>
                <taxon spec="Taxon" id="t92"/>
                <taxon spec="Taxon" id="t93"/>
                <taxon spec="Taxon" id="t94"/>
                <taxon spec="Taxon" id="t95"/>
                <taxon spec="Taxon" id="t96"/>
                <taxon spec="Taxon" id="t97"/>
                <taxon spec="Taxon" id="t98"/>
                <taxon spec="Taxon" id="t99"/>
                <taxon spec="Taxon" id="t100"/>

            </taxa>

            t1=0, t2=0.1, t3=0.2, t4=0.3, t5=0.4,
            t6=0, t7=0.1, t8=0.2, t9=0.3, t10=0.4,

            t11=0, t12=0.1, t13=0.2, t14=0.3, t15=0.4,
            t16=0, t17=0.1, t18=0.2, t19=0.3, t20=0.4,

            t21=0, t22=0.1, t23=0.2, t24=0.3, t25=0.4,
            t26=0, t27=0.1, t28=0.2, t29=0.3, t30=0.4,

            t31=0, t32=0.1, t33=0.2, t34=0.3, t35=0.4,
            t36=0, t37=0.1, t38=0.2, t39=0.3, t40=0.4,

            t41=0, t42=0.1, t43=0.2, t44=0.3, t45=0.4,
            t46=0, t47=0.1, t48=0.2, t49=0.3, t50=0.4,

            t51=0, t52=0.1, t53=0.2, t54=0.3, t55=0.4,
            t56=0, t57=0.1, t58=0.2, t59=0.3, t60=0.4,

            t61=0, t62=0.1, t63=0.2, t64=0.3, t65=0.4,
            t66=0, t67=0.1, t68=0.2, t69=0.3, t70=0.4,

            t71=0, t72=0.1, t73=0.2, t74=0.3, t75=0.4,
            t76=0, t77=0.1, t78=0.2, t79=0.3, t80=0.4,

            t81=0, t82=0.1, t83=0.2, t84=0.3, t85=0.4,
            t86=0, t87=0.1, t88=0.2, t89=0.3, t90=0.4,

            t91=0, t92=0.1, t93=0.2, t94=0.3, t95=0.4,
            t96=0, t97=0.1, t98=0.2, t99=0.3, t100=0.4

        </traitSet>
    </network>

    <run spec="DensityMapper">

        <distribution id="marginalDensity" spec="MarginalCoalescentWithReassortment" nParticles="1000">
            <populationSize idref="truePopSize"/>
            <reassortmentRate idref="reassortmentRate"/>

            <observedEventList spec="ObservedEventList">
                <segmentTree idref="segment1"/>
                <segmentTree idref="segment2"/>
                <segmentTree idref="segment3"/>
                <segmentTree idref="segment4"/>
                <segmentTree idref="segment5"/>
                <segmentTree idref="segment6"/>
                <segmentTree idref="segment7"/>
                <segmentTree idref="segment8"/>
            </observedEventList>
        </distribution>

        <distribution id="networkDensity" spec="CoalescentWithReassortment">
            <networkIntervals spec="NetworkIntervals">
                <network idref="network"/>
            </networkIntervals>

            <populationModel idref="truePopModel"/>
            <reassortmentRate idref="reassortmentRate"/>
        </distribution>

        <realParam id="reassortmentRate" spec="RealParameter"
                   value="1.0" lower="0.1" upper="5.0"/>
        <steps spec="IntegerParameter" value="21"/>

        <logger spec="Logger" logEvery="1" fileName="$(filebase).log">
            <log idref="reassortmentRate"/>
            <log idref="networkDensity"/>
            <!--log idref="marginalDensity"/-->
        </logger>

        <logger spec="Logger" logEvery="1">
            <log idref="reassortmentRate"/>
            <log idref="networkDensity"/>
            <!--log idref="marginalDensity"/-->
        </logger>
    </run>
</beast>